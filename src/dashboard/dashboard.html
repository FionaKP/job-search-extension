<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Job Application Dashboard</title>
  <link rel="stylesheet" href="dashboard.css">
</head>
<body>
  <div class="dashboard">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="sidebar-header">
        <h1>üìã Job Tracker</h1>
      </div>
      
      <!-- Stats Cards -->
      <div class="stats-grid">
        <div class="stat-card stat-total">
          <span class="stat-value" id="statTotal">0</span>
          <span class="stat-label">Total</span>
        </div>
        <div class="stat-card stat-saved">
          <span class="stat-value" id="statSaved">0</span>
          <span class="stat-label">Saved</span>
        </div>
        <div class="stat-card stat-applied">
          <span class="stat-value" id="statApplied">0</span>
          <span class="stat-label">Applied</span>
        </div>
        <div class="stat-card stat-interviewing">
          <span class="stat-value" id="statInterviewing">0</span>
          <span class="stat-label">Interviewing</span>
        </div>
        <div class="stat-card stat-offer">
          <span class="stat-value" id="statOffer">0</span>
          <span class="stat-label">Offers</span>
        </div>
        <div class="stat-card stat-rejected">
          <span class="stat-value" id="statRejected">0</span>
          <span class="stat-label">Rejected</span>
        </div>
      </div>

      <!-- Section Navigation -->
      <nav class="section-nav">
        <button class="section-btn active" data-section="jobs">Jobs</button>
        <button class="section-btn" data-section="connections">Connections</button>
      </nav>

      <!-- Filter by Status -->
      <nav class="filter-nav" id="jobFilters">
        <h3>Filter by Status</h3>
        <button class="filter-btn active" data-status="all">All Applications</button>
        <button class="filter-btn" data-status="saved">Saved</button>
        <button class="filter-btn" data-status="applied">Applied</button>
        <button class="filter-btn" data-status="interviewing">Interviewing</button>
        <button class="filter-btn" data-status="offer">Offer</button>
        <button class="filter-btn" data-status="rejected">Rejected</button>
        <button class="filter-btn" data-status="withdrawn">Withdrawn</button>
      </nav>

      <!-- Connection Filters -->
      <nav class="filter-nav hidden" id="connectionFilters">
        <h3>Filter by Relationship</h3>
        <button class="filter-btn active" data-relationship="all">All Connections</button>
        <button class="filter-btn" data-relationship="recruiter">Recruiter</button>
        <button class="filter-btn" data-relationship="referral">Referral</button>
        <button class="filter-btn" data-relationship="colleague">Colleague</button>
        <button class="filter-btn" data-relationship="mentor">Mentor</button>
        <button class="filter-btn" data-relationship="other">Other</button>
      </nav>

      <!-- Actions -->
      <div class="sidebar-actions">
        <button id="exportBtn" class="btn btn-secondary">
          üì• Export Data
        </button>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Header -->
      <header class="content-header" id="jobsHeader">
        <div class="search-box">
          <svg class="search-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="11" cy="11" r="8"></circle>
            <path d="m21 21-4.35-4.35"></path>
          </svg>
          <input type="text" id="searchInput" placeholder="Search by company or job title...">
        </div>
        
        <div class="sort-controls">
          <label for="sortBy">Sort by:</label>
          <select id="sortBy">
            <option value="dateAdded-desc">Newest First</option>
            <option value="dateAdded-asc">Oldest First</option>
            <option value="company-asc">Company A-Z</option>
            <option value="company-desc">Company Z-A</option>
            <option value="interest-desc">Interest (High to Low)</option>
            <option value="interest-asc">Interest (Low to High)</option>
            <option value="status">Status</option>
          </select>
        </div>

        <div class="view-toggle">
          <button id="viewListBtn" class="view-btn active" title="List View">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="3" y1="6" x2="21" y2="6"></line>
              <line x1="3" y1="12" x2="21" y2="12"></line>
              <line x1="3" y1="18" x2="21" y2="18"></line>
            </svg>
          </button>
          <button id="viewThumbnailBtn" class="view-btn" title="Thumbnail View">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="3" width="8" height="8" rx="1"></rect>
              <rect x="13" y="3" width="8" height="8" rx="1"></rect>
              <rect x="3" y="13" width="8" height="8" rx="1"></rect>
              <rect x="13" y="13" width="8" height="8" rx="1"></rect>
            </svg>
          </button>
          <button id="viewGroupedBtn" class="view-btn" title="Group by Company">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M3 3h7v7H3zM14 3h7v7h-7zM3 14h7v7H3zM14 14h7v7h-7z"></path>
              <line x1="7" y1="7" x2="7" y2="7"></line>
              <line x1="17" y1="7" x2="17" y2="7"></line>
              <line x1="7" y1="17" x2="7" y2="17"></line>
              <line x1="17" y1="17" x2="17" y2="17"></line>
            </svg>
          </button>
        </div>
      </header>

      <!-- Job List -->
      <div id="jobList" class="job-list">
        <!-- Jobs will be rendered here -->
      </div>

      <!-- Empty State -->
      <div id="emptyState" class="empty-state hidden">
        <div class="empty-icon">üìã</div>
        <h2>No applications yet</h2>
        <p>Start tracking your job search by clicking the extension icon on any job posting page.</p>
      </div>

      <!-- No Results State -->
      <div id="noResults" class="empty-state hidden">
        <div class="empty-icon">üîç</div>
        <h2>No matches found</h2>
        <p>Try adjusting your search or filters.</p>
      </div>

      <!-- Connections Section (hidden by default) -->
      <div id="connectionsSection" class="hidden">
        <header class="content-header">
          <div class="search-box">
            <svg class="search-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="11" cy="11" r="8"></circle>
              <path d="m21 21-4.35-4.35"></path>
            </svg>
            <input type="text" id="connectionSearchInput" placeholder="Search connections by name, company, or role...">
          </div>
          <div class="sort-controls">
            <label for="connectionSortBy">Sort by:</label>
            <select id="connectionSortBy">
              <option value="dateAdded-desc">Newest First</option>
              <option value="dateAdded-asc">Oldest First</option>
              <option value="name-asc">Name A-Z</option>
              <option value="name-desc">Name Z-A</option>
              <option value="company-asc">Company A-Z</option>
              <option value="lastContactedDate-desc">Last Contacted</option>
            </select>
          </div>
          <button class="btn btn-primary" id="addConnectionBtn">+ Add Connection</button>
        </header>

        <div id="connectionList" class="connection-list"></div>

        <div id="connectionsEmpty" class="empty-state hidden">
          <div class="empty-icon">üë§</div>
          <h2>No connections yet</h2>
          <p>Start building your network by adding contacts related to your job search.</p>
        </div>

        <div id="connectionsNoResults" class="empty-state hidden">
          <div class="empty-icon">üîç</div>
          <h2>No matches found</h2>
          <p>Try adjusting your search or filters.</p>
        </div>
      </div>
    </main>
  </div>

  <!-- Job Detail Modal -->
  <div id="jobModal" class="modal hidden">
    <div class="modal-backdrop"></div>
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="modalTitle">Job Details</h2>
        <button class="modal-close" id="closeModal">&times;</button>
      </div>
      <div class="modal-body">
        <form id="editForm">
          <div class="form-row">
            <div class="form-group">
              <label for="editTitle">Job Title</label>
              <input type="text" id="editTitle" required>
            </div>
            <div class="form-group">
              <label for="editCompany">Company</label>
              <input type="text" id="editCompany" required>
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label for="editLocation">Location</label>
              <input type="text" id="editLocation">
            </div>
            <div class="form-group">
              <label for="editSalary">Salary</label>
              <input type="text" id="editSalary">
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label for="editStatus">Status</label>
              <select id="editStatus">
                <option value="saved">Saved</option>
                <option value="applied">Applied</option>
                <option value="interviewing">Interviewing</option>
                <option value="offer">Offer</option>
                <option value="rejected">Rejected</option>
                <option value="withdrawn">Withdrawn</option>
              </select>
            </div>
            <div class="form-group">
              <label>Interest Level</label>
              <div class="star-rating" id="editInterest">
                <button type="button" class="star-btn" data-value="1" title="1 star">‚òÖ</button>
                <button type="button" class="star-btn" data-value="2" title="2 stars">‚òÖ</button>
                <button type="button" class="star-btn" data-value="3" title="3 stars">‚òÖ</button>
                <button type="button" class="star-btn" data-value="4" title="4 stars">‚òÖ</button>
                <button type="button" class="star-btn" data-value="5" title="5 stars">‚òÖ</button>
              </div>
            </div>
          </div>
          
          <div class="form-group">
            <label for="editTags">Tags (comma separated)</label>
            <input type="text" id="editTags">
          </div>
          
          <div class="form-group">
            <label for="editNotes">Notes</label>
            <textarea id="editNotes" rows="4"></textarea>
          </div>
          
          <div class="form-group">
            <label>Job Posting</label>
            <a id="editUrl" href="#" target="_blank" class="job-url">View Original Posting</a>
          </div>

          <div class="form-group">
            <label for="editCompanyUrl">Company Website</label>
            <input type="url" id="editCompanyUrl" placeholder="Company website URL (optional)">
          </div>

          <div class="form-group link-row" id="companyLinkRow">
            <a id="editCompanyLink" href="#" target="_blank" class="job-url">Visit Company Website</a>
          </div>

          <div class="form-group">
            <label for="editPortalUrl">Application Portal</label>
            <input type="url" id="editPortalUrl" placeholder="Portal URL (optional)">
          </div>

          <div class="form-group link-row" id="portalLinkRow">
            <a id="editPortalLink" href="#" target="_blank" class="job-url portal-link">Open Application Portal</a>
          </div>

          <div class="form-group">
            <label>Added</label>
            <span id="editDateAdded" class="meta-text"></span>
          </div>

          <!-- Linked Connections -->
          <div class="form-group">
            <label>Linked Connections</label>
            <div id="jobLinkedConnections" class="linked-items-list"></div>
            <div class="link-job-controls">
              <select id="jobLinkConnectionSelect">
                <option value="">-- Link a connection --</option>
              </select>
              <button type="button" id="jobLinkConnectionBtn" class="btn btn-inline-add">Link</button>
            </div>
          </div>

          <div class="modal-actions">
            <button type="button" id="deleteBtn" class="btn btn-danger">Delete</button>
            <button type="submit" class="btn btn-primary">Save Changes</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Connection Detail Modal -->
  <div id="connectionModal" class="modal hidden">
    <div class="modal-backdrop"></div>
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="connectionModalTitle">Connection Details</h2>
        <button class="modal-close" id="closeConnectionModal">&times;</button>
      </div>
      <div class="modal-body">
        <form id="connectionEditForm">
          <div class="form-row">
            <div class="form-group">
              <label for="connName">Name *</label>
              <input type="text" id="connName" required>
            </div>
            <div class="form-group">
              <label for="connRelationship">Relationship</label>
              <select id="connRelationship">
                <option value="recruiter">Recruiter</option>
                <option value="referral">Referral</option>
                <option value="colleague">Colleague</option>
                <option value="mentor">Mentor</option>
                <option value="other">Other</option>
              </select>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="connCompany">Company</label>
              <input type="text" id="connCompany">
            </div>
            <div class="form-group">
              <label for="connRole">Role / Title</label>
              <input type="text" id="connRole">
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="connEmail">Email</label>
              <input type="email" id="connEmail">
            </div>
            <div class="form-group">
              <label for="connPhone">Phone</label>
              <input type="tel" id="connPhone">
            </div>
          </div>

          <div class="form-group">
            <label for="connLinkedin">LinkedIn URL</label>
            <input type="url" id="connLinkedin" placeholder="https://linkedin.com/in/...">
          </div>

          <div class="form-group">
            <label for="connIndustry">Industry</label>
            <input type="text" id="connIndustry">
          </div>

          <div class="form-group">
            <label for="connTags">Tags (comma separated)</label>
            <input type="text" id="connTags">
          </div>

          <div class="form-group">
            <label for="connLastContacted">Last Contacted</label>
            <input type="date" id="connLastContacted">
          </div>

          <div class="form-group">
            <label for="connNotes">Notes</label>
            <textarea id="connNotes" rows="3"></textarea>
          </div>

          <!-- Linked Jobs -->
          <div class="form-group">
            <label>Linked Jobs</label>
            <div id="connLinkedJobs" class="linked-items-list"></div>
            <div class="link-job-controls">
              <select id="connLinkJobSelect">
                <option value="">-- Link a job --</option>
              </select>
              <button type="button" id="connLinkJobBtn" class="btn btn-inline-add">Link</button>
            </div>
          </div>

          <div class="modal-actions">
            <button type="button" id="deleteConnectionBtn" class="btn btn-danger">Delete</button>
            <button type="submit" class="btn btn-primary">Save</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <script src="../utils/storage.js"></script>
  <script src="dashboard.js"></script>
</body>
</html>
